<!DOCTYPE html>
<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf8" />
		<title>jQuery UI Кластер-аналіз</title>
		<link type="text/css" href="css/start/jquery-ui-1.8.16.custom.css" rel="stylesheet" />
    <link type="text/css" href="css/style.css" rel="stylesheet" />
		<script type="text/javascript" src="js/jquery-1.6.2.min.js"></script>
		<script type="text/javascript" src="js/jquery-ui-1.8.16.custom.min.js"></script>
		<script type="text/javascript">
      var TrainingMatrix = Array();
      // Загрузка зображення
      jQuery.fn.loadImage = function() {
        //Навчальна матриця
        function trainingMatrixCreate(src) {
          var image = new Image();
          image.onload = function() {
            var canvas = document.createElement('canvas');
            canvas.width = image.width;
            canvas.height = image.height;
            var context = canvas.getContext('2d');
            context.drawImage(image, 0, 0);
            var imageData = context.getImageData(0, 0, canvas.width, canvas.height);
            var matrixNum = TrainingMatrix.length;
            TrainingMatrix[matrixNum] = Array();
            for(var x = 0; x < canvas.width; x++){
              TrainingMatrix[matrixNum][x] = Array();
              for(var y = 0; y < canvas.height; y++) {
                var index = (y*imageData.width + x) * 4,
                red = imageData.data[index],
                green = imageData.data[index + 1],
                blue = imageData.data[index + 2],
                alpha = imageData.data[index + 3];
                // Формула яскравості: Y = 0.299 * R + 0.587 * G + 0.114 * B
                var bright = Math.round(0.299*red + 0.587*green + 0.114*blue);
                TrainingMatrix[matrixNum][x][y] = bright;
              }
            }
          };
          image.src = src;
          
          //$('#pixel').append(TrainingMatrix[matrixNum][1][1]);
          return true;
        }
        
        function handleFileSelect(evt) {
          evt.stopPropagation();
          evt.preventDefault();
          var files = evt.dataTransfer.files;
          var dropZone = $(this);
          for (var i = 0, f; f = files[i]; i++) {
            if (!f.type.match('image.*')) {
              continue;
            }
            var reader = new FileReader();
            reader.onload = (function(theFile) {
                return function(e) {
                    dropZone.append('<span><img class="thumb" src="' +e.target.result+
                                    '" title="' +theFile.name+ '"/></span>');
                    $( ".thumb" ).draggable({ axis: 'x' }); // Фокус-покус ;)
                    trainingMatrixCreate(e.target.result);
                };
            })(f);
            reader.readAsDataURL(f);
          }
        }
        function handleDragOver(evt) {
          evt.stopPropagation();
          evt.preventDefault();
        }
        var dropZone = $(this)[0];
        dropZone.addEventListener('dragover', handleDragOver, false);
        dropZone.addEventListener('drop', handleFileSelect, false);
        return true;
      }
      
      // Запуск всіх елементів сторінки
      $(function(){
				$('#tabs').tabs();
        $('#drop-zone').loadImage();
			});
		</script>
	</head>
	<body>
		<div id="tabs">
			<ul>
				<li><a href="#tabs-1">Навчальна матриця</a></li>
				<li><a href="#tabs-2">Навчання системи</a></li>
				<li><a href="#tabs-3">Бінарна матриця та еталонний вектор</a></li>
        <li><a href="#tabs-4">Точнісні характеристики</a></li>
        <li><a href="#tabs-5">Екзамен</a></li>
			</ul>
			<div id="tabs-1">
      
        <div id="drop-zone">
          <span class="instruction">Перетягніть сюди зображення для розпізнавання</span>
        </div>
        <div id="pixel">sadasd</div>

<script type="text/javascript">
  jQuery.fn.myTest = {
    a: 123,
    b: 321,
    c: function() {return this.b;}
  }
  $('#pixel').click(function(){alert($(this).myTest.c());});
</script>
      
      </div>
			<div id="tabs-2">Phasellus mattis tincidunt nibh. Cras orci urna, blandit id, pretium vel, aliquet ornare, felis. Maecenas scelerisque sem non nisl. Fusce sed lorem in enim dictum bibendum.</div>
			<div id="tabs-3">Nam dui erat, auctor a, dignissim quis, sollicitudin eu, felis. Pellentesque nisi urna, interdum eget, sagittis et, consequat vestibulum, lacus. Mauris porttitor ullamcorper augue.</div>
      <div id="tabs-4">Nam dui erat, auctor a, dignissim quis, sollicitudin eu, felis. Pellentesque nisi urna, interdum eget, sagittis et, consequat vestibulum, lacus. Mauris porttitor ullamcorper augue.</div>
      <div id="tabs-5">Nam dui erat, auctor a, dignissim quis, sollicitudin eu, felis. Pellentesque nisi urna, interdum eget, sagittis et, consequat vestibulum, lacus. Mauris porttitor ullamcorper augue.</div>
		</div>

	</body>
</html>


